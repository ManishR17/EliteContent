<div class="research-container">
    <div class="header">
        <h1>AI <span class="gradient-text">Research</span></h1>
        <p>Deep web research and synthesis in seconds</p>
    </div>

    <div class="content-grid">
        <!-- Input Panel -->
        <div class="input-panel">
            <!-- REQUIRED FIELDS -->
            <div class="form-section">
                <h3><span class="step-number">1</span> Research Topic</h3>
                <div class="form-group">
                    <label class="form-label">Research Topic *</label>
                    <textarea [(ngModel)]="topic" rows="3" class="form-textarea"
                        placeholder="What do you want to research? e.g., Impact of AI on healthcare in 2025"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Specific Research Question *</label>
                    <input type="text" [(ngModel)]="researchQuestion"
                        placeholder="e.g., How will AI affect doctor-patient relationships?" class="form-input">
                </div>
            </div>

            <!-- OPTIONAL FIELDS -->
            <div class="form-section">
                <details>
                    <summary>Scope & Depth</summary>

                    <div class="grid-2col mt-4">
                        <div class="form-group">
                            <label class="form-label">Depth</label>
                            <select [(ngModel)]="depth" class="form-select">
                                <option *ngFor="let d of depths" [value]="d.value">{{ d.label }}</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Academic Level</label>
                            <select [(ngModel)]="academicLevel" class="form-select">
                                <option *ngFor="let level of academicLevels" [value]="level">{{ level }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid-2col">
                        <div class="form-group">
                            <label class="form-label">Citation Style</label>
                            <select [(ngModel)]="citationStyle" class="form-select">
                                <option *ngFor="let style of citationStyles" [value]="style">{{ style }}</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Sources Count</label>
                            <input type="number" [(ngModel)]="sourcesCount" min="1" max="20" class="form-input">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Word Count (Approx)</label>
                        <input type="number" [(ngModel)]="wordCount" step="100" min="100" class="form-input">
                    </div>
                </details>
            </div>

            <div class="form-section">
                <details>
                    <summary>Focus & Sources</summary>

                    <div class="form-group mt-4">
                        <label class="form-label">Focus Areas (One per line or comma-separated)</label>
                        <textarea [(ngModel)]="focusAreasInput" rows="3" class="form-textarea" placeholder="Financial implications
Social impact
Technological challenges"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Specific Sections Needed (One per line or comma-separated)</label>
                        <textarea [(ngModel)]="sectionsNeededInput" rows="3" class="form-textarea" placeholder="Introduction
Methodology
Results and Discussion"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Sources Provided (URLs - One per line or comma-separated)</label>
                        <textarea [(ngModel)]="sourcesProvidedInput" rows="3" class="form-textarea" placeholder="https://example.com/article1
https://example.com/article2"></textarea>
                    </div>

                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" [(ngModel)]="includeCitations"> Include Citations
                        </label>
                    </div>
                </details>
            </div>

            <button (click)="generateResearch()" [disabled]="!topic || isLoading" class="generate-btn">
                <span *ngIf="!isLoading">üöÄ Start Research</span>
                <span *ngIf="isLoading" class="loading-spinner">‚è≥ Researching...</span>
            </button>

            <div *ngIf="error" class="error-message">
                <span class="error-icon">‚ö†Ô∏è</span>
                {{ error }}
            </div>
        </div>

        <!-- Results Panel -->
        <div class="results-panel">
            <div *ngIf="!result" class="empty-state">
                <div class="empty-icon">üîç</div>
                <h3>Research Results</h3>
                <p class="empty-message">
                    Enter a topic to start.
                    Our AI will search the web, analyze sources, and synthesize a report.
                </p>
            </div>

            <div *ngIf="result" class="results-content">
                <div class="confidence-card">
                    <span class="confidence-value">{{ (result.confidence_score * 100) | number:'1.0-0' }}%</span>
                    <span class="confidence-label">Confidence Score</span>
                </div>

                <div class="summary-section">
                    <h3>Executive Summary</h3>
                    <div class="summary-content">{{ result.summary }}</div>
                </div>

                <div class="findings-section" *ngIf="result.key_findings && result.key_findings.length > 0">
                    <h3>üîë Key Findings</h3>
                    <ul class="findings-list">
                        <li *ngFor="let finding of result.key_findings">{{ finding }}</li>
                    </ul>
                </div>

                <div class="sources-section" *ngIf="result.sources && result.sources.length > 0">
                    <h3>üìö Sources</h3>
                    <div class="sources-list">
                        <div *ngFor="let source of result.sources" class="source-item">
                            <a [href]="source.url" target="_blank" class="source-title">{{ source.title }}</a>
                            <p class="source-snippet">{{ source.snippet }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>